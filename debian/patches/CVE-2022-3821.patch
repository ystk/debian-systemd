From: Markus Koschany <apo@debian.org>
Date: Wed, 2 Aug 2023 10:54:20 +0200
Subject: CVE-2022-3821

Origin: https://github.com/systemd/systemd-stable/commit/72d4c15a946d20143cd4c6783c802124bc894dc7
---
 src/shared/time-util.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/shared/time-util.c b/src/shared/time-util.c
index d5c5217..bf6060d 100644
--- a/src/shared/time-util.c
+++ b/src/shared/time-util.c
@@ -349,7 +349,7 @@ char *format_timespan(char *buf, size_t l, usec_t t, usec_t accuracy) {
                         t = b;
                 }
 
-                n = MIN((size_t) k, l);
+                n = MIN((size_t) k, l-1);
 
                 l -= n;
                 p += n;
